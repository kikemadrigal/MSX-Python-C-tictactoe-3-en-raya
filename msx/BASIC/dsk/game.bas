30cls
40gosub1000
50tu=0:p0=0:p1=0:te=0
60em=0:w0=0:w1=0
80fori=0to8
90c$(i)="_"
100nexti
110ifrnd(1)*10>4thentu=1
200gosub1200
210le$="X":gosub2800
220le$="O":gosub2800
    230 if w0=1 then p0=p0+1:locate 0,17:if np=1 then print "Player win":gosub 600:goto 60 else print "Player 1 win":gosub 600:goto 60
    240 if w1=1 then p1=p1+1:locate 0,17:if np=1 then print "MSX win":gosub 600:goto 60 else print "Player 2 win":gosub 600:goto 60
250gosub4000
    260 if em=1 then te=te+1:locate 0,17:print "Tied":gosub 600:goto 60
270iftu=0thengosub2000elseifnp=1thengosub3000elsegosub2100
500goto200
600locate0,18:print"Pressspacetocontinue,esctoexit"
610k$=INKEY$:IFk$=CHR$(27)THENGOTO30
620ifstrig(0)=-1thenreturnelsegoto610
1000Locate13,0:print"3enraya"
1010Locate13,2:print"MSXSpain"
1040Locate4,10:print"Press1player<>MSX"
1050Locate4,12:print"Press2player1<>player2"
1060k$=INKEY$:IFk$=""THENGOTO1060
1070IFk$<>"1"andk$<>"2"THENGOTO1060
1080ifk$="1"thennp=1elseifk$="2"thennp=2
1150RETURN
1200cls
1210locate2,3:ifnp=1thenprint"Player:"p0"MSX:"p1"tied:"teelseprint"player1:"p0"player2:"p1"tied:"te
1220co=0
1225fori=8to13:locate10,i:print"|":locate18,i:print"|":nexti
1226fori=10to18:locatei,7:print"-":locatei,14:print"-":nexti
1240fori=0to8
1250ifi<3thenlocate20,8:print"123":locate(6+co+i)*2,8
1255ifi>=3andi<6thenlocate20,10:print"456":co=(6+(i-3))*2:locateco,10
1260ifi>=6andi<9thenlocate20,12:print"789":co=(6+(i-6))*2:locateco,12
1270printc$(i)
1280nexti
1290return
2000locate0,17:ifnp=1thenprint"Playerturn"elseprint"Player1turn"
2010k$=INKEY$
2020IFk$=CHR$(27)THENGOTO30
2030IFk$<"0"ORk$>"9"ORk$=""THENGOTO2000
2040se=VAL(k$):se=se-1
2050ifc$(se)="_"thenc$(se)="X"elselocate0,15:print"Ocupada,pruebaotravez":fori=0to500:nexti:locate0,15:print"":goto2000
2060tu=1
2070locate0,15:print""
2090return
2100locate0,17:print"Player2turn"
2110k$=INKEY$
2120IFk$=CHR$(27)THENGOTO30
2130IFk$<"0"ORk$>"9"ORk$=""THENGOTO2110
2140se=VAL(k$):se=se-1
2150ifc$(se)="_"thenc$(se)="O"elselocate0,15:print"Ocupada,pruebaotravez":fori=0to500:nexti:locate0,15:print"":goto2110
2160tu=0
2170locate0,15:print""
2190return
2800ra=0
2810ifc$(0)=le$andc$(1)=le$andc$(2)=le$thenra=1
2820ifc$(3)=le$andc$(4)=le$andc$(5)=le$thenra=1
2830ifc$(6)=le$andc$(7)=le$andc$(8)=le$thenra=1
2840ifc$(0)=le$andc$(3)=le$andc$(6)=le$thenra=1
2850ifc$(1)=le$andc$(4)=le$andc$(7)=le$thenra=1
2860ifc$(2)=le$andc$(5)=le$andc$(8)=le$thenra=1
2870ifc$(0)=le$andc$(4)=le$andc$(8)=le$thenra=1
2880ifc$(6)=le$andc$(4)=le$andc$(2)=le$thenra=1
2885ifra=1thenifle$="X"thenw0=1elseifle$="O"thenw1=1
2890return
3000locate0,17:print"MSXturn..."
3010fori=0to9
3030ifc$(i)="_"thenc$(i)="O":le$="O":gosub2800:c$(i)="_"
3040ifw1=1thenc$(i)="O":tu=0:return
3050nexti
3060gosub3100
3090return
3100fori=0to9
3120ifc$(i)="_"thenc$(i)="X":le$="X":gosub2800:c$(i)="_"
3130ifw0=1thenw0=0:c$(i)="O":tu=0:return
3140nexti
3150gosub3900
3190return
3900se=rnd(1)*9
3910ifc$(se)="_"thenc$(se)="O"elsegoto3900
3940tu=0
3990return
4000em=1
4040fori=0to8
4050ifc$(i)="_"thenem=0
4060nexti
4090return
