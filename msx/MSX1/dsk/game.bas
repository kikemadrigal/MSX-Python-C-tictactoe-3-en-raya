10color15,1,1:keyoff
20dimc$(9)
30tu=0:em=0:w0=0:w1=0:i1=0
40fori=0to8
50c$(i)="_"
60nexti
70cls
80gosub1000
90ifrnd(1)*10>4thentu=1
100gosub1200
120le$="X":gosub2100
130le$="O":gosub2100
200ifw0=1thenlocate0,15:print"Playergana,pulseespacioparaempezar":gosub600:goto30
210ifw1=1thenlocate0,15:print"MSXgana,pulseespacioparaempezar":gosub600:goto30
220gosub4000
230ifem=1thenlocate0,15:print"Empate,pulseespacioparaempezar":gosub600:goto30
240iftu=0thengosub2000elsegosub3000
500goto100
600ifstrig(0)=-1thenreturnelsegoto600
1000Locate10,0:print"3enraya"
1010Locate10,2:print"MSXSpain"
1040Locate4,10:print"1jugarcontraMSX"
1050Locate4,12:print"2jugador1contrajugador2"
1060k$=INKEY$:IFk$=""THENGOTO1060
1070IFk$<>"1"THENGOTO1060
1150RETURN
1200cls
1205locate10,0:print"3enraya"
1210co=0
1215locate2,4:print"-----------------"
1220fori=0to8
1230ifi<3thenlocate12,6:print"123":locate(2+co+i)*2,6
1250ifi>=3andi<6thenlocate12,8:print"456":co=(2+(i-3))*2:locateco,8
1260ifi>=6andi<9thenlocate12,10:print"789":co=(2+(i-6))*2:locateco,10
1270printc$(i)
1280nexti
1285locate2,12:print"-----------------"
1290return
2000locate0,15:print"Turnoplayer"
2010LETk$=INKEY$
2020IFk$=CHR$(27)THENGOTO30
2030IFk$<"0"ORk$>"9"ORk$=""THENGOTO2000
2040se=VAL(k$):se=se-1
2050ifc$(se)="_"thenc$(se)="X"elselocate0,15:print"Ocupada,pruebaotravez":fori=0to500:nexti:locate0,15:print"":goto2000
2060tu=1
2070locate0,15:print""
2090return
2100ra=0
2110ifc$(0)=le$andc$(1)=le$andc$(2)=le$thenra=1
2120ifc$(3)=le$andc$(4)=le$andc$(5)=le$thenra=1
2130ifc$(6)=le$andc$(7)=le$andc$(8)=le$thenra=1
2140ifc$(0)=le$andc$(3)=le$andc$(6)=le$thenra=1
2150ifc$(1)=le$andc$(4)=le$andc$(7)=le$thenra=1
2160ifc$(2)=le$andc$(5)=le$andc$(8)=le$thenra=1
2170ifc$(0)=le$andc$(4)=le$andc$(8)=le$thenra=1
2180ifra=1thenifle$="X"thenw0=1elseifle$="O"thenw1=1
2190return
3000locate0,15:print"TurnoMSX..."
3010fori=0to9
3020ifc$(i)="_"thenc$(i)="O":le$="O":gosub2100:c$(i)="_"
3030ifw1=1thenc$(i)="O":return
3050nexti
3060ifw1=0thengosub3100
3090return
3100d1=0
3110fori=0to9
3120ifc$(i)="_"thenc$(i)="X":le$="X":gosub2100:c$(i)="_"
3130ifw0=1thend1=1:w0=0:c$(i)="O":tu=0:return
3140nexti
3150ifd1=0thengosub3900
3190return
3900se=rnd(1)*9
3910ifc$(se)="_"thenc$(se)="O"elsegoto3900
3940tu=0
3990return
4000em=1
4040fori=0to8
4050ifc$(i)="_"thenem=0
4060nexti
4090return
